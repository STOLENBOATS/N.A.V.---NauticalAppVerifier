(function(){const i=document.getElementById('fotoMotor');async function toDataURL(f){return await new Promise((res,rej)=>{const fr=new FileReader();fr.onload=()=>res(fr.result);fr.onerror=rej;fr.readAsDataURL(f);});}function resize(dataURL,max=800){return new Promise((res,rej)=>{const img=new Image();img.onload=()=>{let w=img.width,h=img.height;const r=w>h?max/w:max/h;if(r<1){w=Math.round(w*r);h=Math.round(h*r);}const c=document.createElement('canvas');c.width=w;c.height=h;const ctx=c.getContext('2d');ctx.drawImage(img,0,0,w,h);res(c.toDataURL('image/jpeg',0.85));};img.onerror=rej;img.src=dataURL;});}if(i){i.addEventListener('change',async e=>{const f=e.target.files&&e.target.files[0];if(!f)return;const raw=await toDataURL(f);const small=await resize(raw,800);sessionStorage.setItem('motor_last_photo', small);});}})();